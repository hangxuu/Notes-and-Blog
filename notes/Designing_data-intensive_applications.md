# 数据密集型应用系统设计

<!-- GFM-TOC -->

* [一、可靠、可扩展与可维护的应用系统](#可靠、可扩展与可维护的应用系统)
* [二、数据模型与查询语言](#数据模型与查询语言)

<!-- GFM-TOC -->


## 可靠、可扩展与可维护的应用系统
对可靠性、可扩展性与可维护性的理解。

可靠性
- 硬件故障：为硬件添加冗余。
- 软件错误
- 人为失误：以最小出错的方式来设计系统、分离接口、充分测试、监控系统、人员培训等。

可扩展性
- 描述负载：服务器每秒请求处理次数、聊天室同时活动用户数量、缓存命中率等。
- 描述性能：吞吐量、服务的响应时间，通常用百分位数来表示。
- 垂直扩展（升级到更强大的机器）与水平扩展（将负载分布到多个更小的机器）

可维护性
- 可运维性：方便运营团队来保持系统平稳运行。
- 简单性：简化复杂度。设计抽象，可重用组件。
- 可演化性：易于改变。简单易懂的系统往往比复杂的系统更容易修改。

## 数据模型与查询语言

### 关系模型与文档模型
对于个人简历的例子，JSON表示比多表模式具有更好的局部性。如果要在关系模式中读取一份简历，那么要么执行多个查询（通过user_id查询每个表），要么在users表及其从属表之间执行混乱的多路联结。而对于JSON表示方法，所有的相关信息都在一个地方，一次查询就够了。

文档模型通过支持树状结构省去了关系模型的联结操作，但其难以表示多对一以及多对多关系。

多对一关系是数据规范化的结果，那么就先谈谈数据规范化。比如美国，如果个人简历中的国籍列是文本类型，那么可能有人写美国，有人写美利坚合众国或者其它名称，就会造成数据的不一致，如果以后由于某种原因，美国改名为丑国，那就得更改所有的副本。使用标准化的地理区域和行业列表，有以下优势：

- 所有的简历保持样式和输入值一致。
- 避免歧义（例如，如果存在一些同名的城市）
- 易于更新：名字只保存在一个地方，因此，如果需要改变，可以很容易全面更新。
- 本地化支持以及更好的搜索支持。

### 关系数据库与文档数据库现状
支持文档数据模型的主要论点是模式灵活性，由于局部性而带来较好的性能，对于某些应用来说，它更接近于应用程序所使用的数据结构。关系模型则强在联结操作、 多对一和多对多关系更简洁的表达上，与文档模型抗衡。

文档模型中的模式灵活性

- 读时模式：数据的结构是隐式的，只有在读取时才解释。    --文档模型
- 写时模式：模式是显式的，并且数据库确保数据写入时都必须遵循。    --关系模型

类似编程语言中的动态类型检查和静态类型检查。

近些年，关系数据库和文档数据库变得越来越相近，融合关系模型与文档模型是未来数据库发展的一条很好的途径。

### 数据查询语言